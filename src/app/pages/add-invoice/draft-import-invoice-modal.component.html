<div class="modal-container">
    <div class="modal-header">
        <h2 mat-dialog-title>Import Invoice</h2>
    </div>

    <div mat-dialog-content class="modal-content">
        <div class="add-file-section">
            <input #fileInput type="file" accept=".csv,.xlsx,.xls" style="display: none"
                (change)="onFileSelected($event)">
            <button mat-raised-button color="primary" class="add-file-button" (click)="onAddFile()">
                <mat-icon>add</mat-icon> Add File
            </button>
        </div>

        <form [formGroup]="invoiceForm">
            <table mat-table [dataSource]="invoices.controls" class="invoice-table">
                <!-- Booking No Column -->
                <ng-container matColumnDef="bookingNo">
                    <th mat-header-cell *matHeaderCellDef>Booking No.</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput formControlName="bookingNo">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- Customer Invoice Column -->
                <ng-container matColumnDef="customerInvoice">
                    <th mat-header-cell *matHeaderCellDef>Customer Invoice</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput formControlName="customerInvoice">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- W Column -->
                <ng-container matColumnDef="w">
                    <th mat-header-cell *matHeaderCellDef>W</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="w">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- L Column -->
                <ng-container matColumnDef="l">
                    <th mat-header-cell *matHeaderCellDef>L</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="l">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- H Column -->
                <ng-container matColumnDef="h">
                    <th mat-header-cell *matHeaderCellDef>H</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="h">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- CBM Column -->
                <ng-container matColumnDef="cbm">
                    <th mat-header-cell *matHeaderCellDef>CBM</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="cbm">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- HAWB No Column -->
                <ng-container matColumnDef="hawbNo">
                    <th mat-header-cell *matHeaderCellDef>HAWB No.</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput formControlName="hawbNo">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- Weight Column -->
                <ng-container matColumnDef="weight">
                    <th mat-header-cell *matHeaderCellDef>Weight</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="weight">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- Cargo Qty Column -->
                <ng-container matColumnDef="cargoQty">
                    <th mat-header-cell *matHeaderCellDef>Cargo Qty</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="cargoQty">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- Units(Qty) Column -->
                <ng-container matColumnDef="cargoUnit">
                    <th mat-header-cell *matHeaderCellDef>Units(Qty)</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput formControlName="cargoUnit">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- Price Column -->
                <ng-container matColumnDef="price">
                    <th mat-header-cell *matHeaderCellDef>Price</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput type="number" formControlName="price">
                        </mat-form-field>
                    </td>
                </ng-container>

                <!-- Units(Price) Column -->
                <ng-container matColumnDef="priceUnit">
                    <th mat-header-cell *matHeaderCellDef>Units(Price)</th>
                    <td mat-cell *matCellDef="let row; let i = index" [formGroup]="row">
                        <mat-form-field class="cell-input">
                            <input matInput formControlName="priceUnit">
                        </mat-form-field>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </form>

        <div class="info-text">
            <p>เมื่อกด Import มาแล้วจะแสดงหน้า Import Invoice เพื่อแน่นใจก่อน Import</p>
            <p>แล้ว ระบบจำคำนำหน้าเป็น Drafts ก่อนทำการ Import เข้า ระบบ</p>
            <p>ยังสามารถแก้ไขข้อมูลผ่านหน้าข้อมูลได้เลย</p>
        </div>
    </div>

    <div mat-dialog-actions class="modal-actions">
        <button mat-raised-button class="cancel-button" (click)="onCancel()">Cancel</button>
        <button mat-raised-button color="accent" class="save-button" (click)="onSave()">Save</button>
    </div>
</div>